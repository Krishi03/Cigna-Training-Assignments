CREATE TABLE DEPT(
    DEPTNO NUMBER PRIMARY KEY,
    DNAME VARCHAR(50),
    LOC VARCHAR(50)
    );


CREATE TABLE EMPS (
    EMPNO NUMBER PRIMARY KEY,
    ENAME VARCHAR(50),
    JOB VARCHAR(20),
    SAL NUMBER, 
    DEPTNUM NUMBER,
    CONSTRAINT FK_EMP FOREIGN KEY (DEPTNUM) REFERENCES DEPT(DEPTNO)ON DELETE CASCADE
    );
    
INSERT INTO DEPT(DEPTNO,DNAME,LOC) VALUES(1, 'PRODUCT', 'BANGALORE');
INSERT INTO DEPT(DEPTNO,DNAME,LOC) VALUES(2, 'ENGINEERING', 'HYDERABAD');
INSERT INTO DEPT(DEPTNO,DNAME,LOC) VALUES(3, 'OPERATIONS', 'MUMBAI');
INSERT INTO DEPT(DEPTNO,DNAME,LOC) VALUES(4, 'MARKETING', 'BANGALORE');
INSERT INTO DEPT(DEPTNO,DNAME,LOC) VALUES(5, 'SALES', 'BANGALORE');

INSERT INTO EMPS(EMPNO, ENAME, JOB, SAL, DEPTNUM) VALUES(1, 'KRISHI', 'ASSOCIATE ANALYST', 75000, 2);
INSERT INTO EMPS(EMPNO, ENAME, JOB, SAL, DEPTNUM) VALUES(2, 'ADEEB', 'PRODUCT ANALYST', 45000, 1);
INSERT INTO EMPS(EMPNO, ENAME, JOB, SAL, DEPTNUM) VALUES(3, 'VINISHA', 'OPERATION ANALYST', 70000, 3);
INSERT INTO EMPS(EMPNO, ENAME, JOB, SAL, DEPTNUM) VALUES(4, 'SAKET', 'MARKETING ANALYST', 25000, 4);
INSERT INTO EMPS(EMPNO, ENAME, JOB, SAL, DEPTNUM) VALUES(5, 'ZUBAIR', 'SALES ANALYST', 15000, 5);

--QUERIES--
1)SELECT ENAME , DNAME 
FROM EMPS INNER JOIN DEPT
ON DEPTNUM = DEPTNO;

2)SELECT ENAME, JOB, LOC
FROM EMPS JOIN DEPT
ON DEPTNUM=DEPTNO;

3)SELECT * FROM EMPS INNER JOIN DEPT
ON DEPTNUM=DEPTNO
WHERE DNAME='SALES';

4)SELECT EMPNO,ENAME , DNAME, LOC 
FROM EMPS 
RIGHT JOIN DEPT
ON DEPTNUM=DEPTNO;

5)SELECT DEPTNO, DNAME,ENAME 
FROM EMPS
LEFT JOIN DEPT
ON DEPTNUM=DEPTNO;

6)SELECT DNAME , SUM(SAL) AS TOTAL_SALARY
FROM EMPS INNER JOIN DEPT
ON DEPTNUM=DEPTNO
GROUP BY DNAME;

7)SELECT DNAME , COUNT(EMPNO)
FROM EMPS INNER JOIN DEPT
ON DEPTNUM=DEPTNO
GROUP BY DNAME
HAVING COUNT(EMPNO)>3;

8)SELECT ENAME FROM EMPS, DEPT
WHERE DEPTNUM=DEPTNO AND LOC IN 
(SELECT LOC FROM DEPT WHERE DNAME='PRODUCT');

9)SELECT ENAME,DNAME,MAX(SAL) AS HIHEST_SALARY FROM EMPS
INNER JOIN DEPT ON DEPTNUM=DEPTNO
GROUP BY DNAME,ENAME;

10)SELECT E.EMPNO, E.ENAME, E.SAL , D.DNAME
FROM EMPS E INNER JOIN DEPT D
ON E.DEPTNUM=D.DEPTNO 
WHERE E.SAL >= (SELECT AVG(E1.SAL) FROM EMPS E1,DEPT WHERE E1.DEPTNUM=E.DEPTNUM);
